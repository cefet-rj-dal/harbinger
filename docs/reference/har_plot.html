<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Plot event detection on a time series — har_plot • harbinger</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot event detection on a time series — har_plot"><meta name="description" content="It accepts as harbinger, a time series, a data.frame of events, a parameter to mark the detected change points, a threshold for the y-axis and an index for the time series"><meta property="og:description" content="It accepts as harbinger, a time series, a data.frame of events, a parameter to mark the detected change points, a threshold for the y-axis and an index for the time series"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">harbinger</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.727</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/cefet-rj-dal/harbinger/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Plot event detection on a time series</h1>
      <small class="dont-index">Source: <a href="https://github.com/cefet-rj-dal/harbinger/blob/HEAD/R/har_plot.R" class="external-link"><code>R/har_plot.R</code></a></small>
      <div class="d-none name"><code>har_plot.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>It accepts as harbinger, a time series, a data.frame of events, a parameter to mark the detected change points, a threshold for the y-axis and an index for the time series</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">har_plot</span><span class="op">(</span></span>
<span>  <span class="va">obj</span>,</span>
<span>  <span class="va">serie</span>,</span>
<span>  <span class="va">detection</span>,</span>
<span>  event <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mark.cp <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  ylim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  idx <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pointsize <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"green"</span>, <span class="st">"blue"</span>, <span class="st">"red"</span>, <span class="st">"purple"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-obj">obj<a class="anchor" aria-label="anchor" href="#arg-obj"></a></dt>
<dd><p>harbinger detector</p></dd>


<dt id="arg-serie">serie<a class="anchor" aria-label="anchor" href="#arg-serie"></a></dt>
<dd><p>time series</p></dd>


<dt id="arg-detection">detection<a class="anchor" aria-label="anchor" href="#arg-detection"></a></dt>
<dd><p>detection</p></dd>


<dt id="arg-event">event<a class="anchor" aria-label="anchor" href="#arg-event"></a></dt>
<dd><p>events</p></dd>


<dt id="arg-mark-cp">mark.cp<a class="anchor" aria-label="anchor" href="#arg-mark-cp"></a></dt>
<dd><p>show change points</p></dd>


<dt id="arg-ylim">ylim<a class="anchor" aria-label="anchor" href="#arg-ylim"></a></dt>
<dd><p>limits for y-axis</p></dd>


<dt id="arg-idx">idx<a class="anchor" aria-label="anchor" href="#arg-idx"></a></dt>
<dd><p>labels for x observations</p></dd>


<dt id="arg-pointsize">pointsize<a class="anchor" aria-label="anchor" href="#arg-pointsize"></a></dt>
<dd><p>default point size</p></dd>


<dt id="arg-colors">colors<a class="anchor" aria-label="anchor" href="#arg-colors"></a></dt>
<dd><p>default colors for event detection: green is TP, blue is FN, red is FP, purple means observations that are part of a sequence.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A time series plot with marked events</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://cefet-rj-dal.github.io/daltoolbox/" class="external-link">daltoolbox</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#loading the example database</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">examples_anomalies</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Using the simple time series</span></span></span>
<span class="r-in"><span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="va">examples_anomalies</span><span class="op">$</span><span class="va">simple</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       serie event</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 1.0000000 FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.9689124 FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0.8775826 FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 0.7316889 FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 0.5403023 FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 0.3153224 FALSE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># setting up time change point using GARCH</span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="hanr_arima.html">hanr_arima</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># fitting the model</span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/daltoolbox/man/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">dataset</span><span class="op">$</span><span class="va">serie</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># making detections</span></span></span>
<span class="r-in"><span><span class="va">detection</span> <span class="op">&lt;-</span> <span class="fu"><a href="detect.html">detect</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">dataset</span><span class="op">$</span><span class="va">serie</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># filtering detected events</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">detection</span><span class="op">[</span><span class="op">(</span><span class="va">detection</span><span class="op">$</span><span class="va">event</span><span class="op">)</span>,<span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    idx event    type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50  50  TRUE anomaly</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># evaluating the detections</span></span></span>
<span class="r-in"><span><span class="va">evaluation</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/daltoolbox/man/evaluate.html" class="external-link">evaluate</a></span><span class="op">(</span><span class="fu"><a href="har_eval_soft.html">har_eval_soft</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">detection</span><span class="op">$</span><span class="va">event</span>, <span class="va">dataset</span><span class="op">$</span><span class="va">event</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">evaluation</span><span class="op">$</span><span class="va">confMatrix</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           event      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> detection TRUE  FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TRUE      1     0    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FALSE     0     100  </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ploting the results</span></span></span>
<span class="r-in"><span><span class="va">grf</span> <span class="op">&lt;-</span> <span class="fu">har_plot</span><span class="op">(</span><span class="va">model</span>, <span class="va">dataset</span><span class="op">$</span><span class="va">serie</span>, <span class="va">detection</span>, <span class="va">dataset</span><span class="op">$</span><span class="va">event</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">grf</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="har_plot-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Eduardo Ogasawara, Antonio Castro, Antonio Mello, Ellen Paixão, Fernando Fraga, Heraldo Borges, Janio Lima, Jessica Souza, Lais Baroni, Lucas Tavares, Michel Reis, Rebecca Salles, Diego Carvalho, Eduardo Bezerra, Rafaelli Coutinho, Esther Pacitti, Fabio Porto.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

